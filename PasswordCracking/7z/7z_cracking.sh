#!/bin/bash
# 7zip-JTR Decrypt Script
#
# Clone of JTR Decrypt Scripts by synacl modified for 7zip

echo "7zip-JTR Decrypt Script";
if [ $# -ne 2 ]
then
  echo "Usage $0 <7z file> <wordlist>";
  exit;
fi
7z l $1

echo "Generating wordlist..."
john --wordlist="$2" --rules --stdout | while read i
do
  7z x -p$i $1 -aoa > /dev/null 2>&1
  STATUS=$?
  if [ $STATUS -eq 0 ]; then
    echo -e "\rArchive password is: \"$i\"" 
    exit 0
  fi
done